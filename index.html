<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Debugging C Program: Average Calculation</title>
</head>
<body>
    <h1>Debugging C Program: Average Calculation</h1>

    <p>This document provides solutions to common debugging issues encountered in a C program that calculates the average of an array of numbers.</p>

    <h2>Debugging Questions</h2>

    <p>The following questions address potential issues and suggest solutions to ensure the program functions correctly.</p>

    <h3>Question 1: Loop Issue</h3>

    <p>**Problem:** The `for` loop in the `calculateAverage` function iterates one element beyond the array size. This can lead to unexpected behavior and incorrect output.</p>

    <p>**Solution:** Change the loop condition from `i <= size` to `i < size`. This ensures the loop iterates only through valid elements within the array bounds.</p>

    <h3>Question 2: Integer Division Issue</h3>

    <p>**Problem:** If the array contains decimal values, using integer division (`sum / size`) truncates the result, leading to an incorrect (lower) average.</p>

    <p>**Solution:** Cast one of the operands to `double` before division. This forces floating-point division and preserves decimals, providing a more accurate average.</p>

    <h3>Question 3: Integer Overflow with `int` for `sum`</h3>

    <p>**Problem:** Using `int` for the `sum` variable can lead to overflow if the array contains very large numbers. This causes incorrect results due to exceeding the maximum value an `int` can hold.</p>

    <p>**Solution:** Use a data type with a larger range, such as `long long` or a floating-point type like `double`. The choice depends on the expected range of numbers and desired precision.</p>

    <h3>Question 4: Handling Empty Arrays</h3>

    <p>**Problem:** Dividing by zero in the average calculation (`average = sum / size`) when the array is empty (size is 0) results in undefined behavior or a program crash.</p>

    <p>**Solution:** Add a check in `calculateAverage` to handle empty arrays gracefully. You can return a specific value (e.g., `-1.0`) to indicate an error or throw an exception for more robust error handling.</p>

    <h2>Improved Program with Best Practices</h2>

    <p>Here's the improved C program incorporating the solutions to the debugging questions and following best practices for maintainability and robustness:</p>

    <pre><code>
#include &lt;stdio.h&gt;

long long calculateAverage(int numbers[], int size) {
    if (size == 0) {
        return -1.0; // Or throw an exception
    }

    long long sum = 0;  // Use a larger data type to avoid overflow
    for (int i = 0; i &lt; size; i++) {
        sum += numbers[i];
    }
    return (double)sum / size;
}

int main() {
    int numbers[] = {5, 10, 15, 20, 25};
    int size = sizeof(numbers) / sizeof(numbers[0]);

    double average = calculateAverage(numbers, size);

    if (average == -1.0) {
        printf("Error: Empty array\n");
    } else {
        printf("Average: %f\n", average);
    }

    return 0;
}
</code></pre>

    <p>This improved program addresses the identified issues, handles empty arrays gracefully, and uses appropriate data types for reliability and better code readability.</p>
</body>
</html>
